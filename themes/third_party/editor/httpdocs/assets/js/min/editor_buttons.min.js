if("undefined"==typeof EditorButtons)var EditorButtons={};if(EditorButtons.Link={},EditorButtons.PastePlainText={},EditorButtons.Templates={},EditorButtons.Styles={},"undefined"==typeof RedactorPlugins)var RedactorPlugins={};RedactorPlugins.dd_keyboard_shortcuts={init:function(){this.$editor.parent().on("keydown",$.proxy(function(t){var e=t.which,a=t.ctrlKey||t.metaKey;return a&&68===e?(t.preventDefault(),this.toggle(),!1):void 0},this))}},EditorButtons.Link.OpenModal=function(){var t=this;t.selectionSave();var e=EditorButtons.Link.ModalContent(t);t.modalInit(t.opts.curLang.link,e,460,function(){t.insert_link_node=!1;var e=this.getSelection(),a="",r="",n="",o=t.getParent();o&&"A"===o.tagName?(a=o.href,r=$(o).text(),n=o.target,""===e.toString()&&(t.insert_link_node=o)):r=e.toString(),$(".redactor_link_text").val(r);var i=self.location.href.replace(/\/$/i,""),l=a.replace(i,"");0===a.search("mailto:")?(t.modalSetTab.call(t,4),$("#redactor_tab_selected").val(4),$("#redactor_link_mailto").val(a.replace("mailto:",""))):0===l.search(/^#/gi)?(t.modalSetTab.call(t,5),$("#redactor_tab_selected").val(5),$("#redactor_link_anchor").val(l.replace(/^#/gi,""))):$("#redactor_navee").find("option[value='"+a+"']").length>0?(t.modalSetTab.call(t,3),$("#redactor_tab_selected").val(3),$("#redactor_navee").val(a)):$("#redactor_site_page").find("option[value='"+a+"']").length>0?(t.modalSetTab.call(t,2),$("#redactor_tab_selected").val(2),$("#redactor_site_page").val(a)):$("#redactor_link_url").val(a),"_blank"===n&&$(".redactor_link_blank").attr("checked",!0),$("#redactor_insert_link_btn").click(function(e){EditorButtons.Link.InsertLink(t,e)}),$("#redactor_modal").find(".redactor_tab:visible").find(".redactor_input:first").focus()})},EditorButtons.Link.ModalContent=function(t){var e=[];return'<div id="redactor_modal_content"><div id="redactor_modal_inner"><section><textarea id="redactor_paste_plaintext_area" style="height:400px"></textarea></section><footer><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+t.opts.curLang.cancel+"</a>"+'<input type="button" class="redactor_modal_btn" id="redactor_save_plain_text" value="'+t.opts.curLang.insert+'" />'+"</footer>"+"</div>",e.push('<div id="redactor_modal_content">'),e.push('<div id="redactor_modal_inner">'),e.push("<section>"),e.push('<form id="redactorInsertLinkForm" method="post" action="">'),e.push('<div id="redactor_tabs">'),e.push('<a href="javascript:void(null);" class="redactor_tabs_act">URL</a>'),EditorButtons.site_pages?e.push('<a href="javascript:void(null);">Site Page</a>'):(EditorButtons.site_pages="",e.push('<a href="javascript:void(null);" style="display:none;">Site Page</a>')),EditorButtons.navee?e.push('<a href="javascript:void(null);">NavEE</a>'):(EditorButtons.navee="",e.push('<a href="javascript:void(null);" style="display:none;">NavEE</a>')),e.push('<a href="javascript:void(null);">Email</a>'),e.push('<a href="javascript:void(null);">'+t.opts.curLang.anchor+"</a>"),e.push("</div>"),e.push('<input type="hidden" id="redactor_tab_selected" value="1" />'),e.push('<div class="redactor_tab" id="redactor_tab1"><label>URL</label><input type="text" id="redactor_link_url" class="redactor_input"  /><label>'+t.opts.curLang.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_url_text" />'+'<label><input type="checkbox" class="redactor_link_blank" id="redactor_wwwink_blank"> '+t.opts.curLang.link_new_tab+"</div>"),e.push('<div class="redactor_tab" id="redactor_tab2" style="display: none;"><label>Site Page</label><select id="redactor_site_page" style="width:100%">'+EditorButtons.site_pages+"</select>"+"<label>"+t.opts.curLang.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_site_page_text" />'+'<label><input type="checkbox" class="redactor_link_blank" id="redactor_site_page_blank"> '+t.opts.curLang.link_new_tab+"</div>"),e.push('<div class="redactor_tab" id="redactor_tab3" style="display: none;"><label>Link Item</label><select id="redactor_navee" style="width:100%">'+EditorButtons.navee+"</select>"+"<label>"+t.opts.curLang.text+'</label><input type="text"  class="redactor_input redactor_link_text" id="redactor_site_page_text" />'+'<label><input type="checkbox" class="redactor_link_blank" id="redactor_navee_blank"> '+t.opts.curLang.link_new_tab+"</div>"),e.push('<div class="redactor_tab" id="redactor_tab4" style="display: none;"><label>Email</label><input type="text" id="redactor_link_mailto" class="redactor_input" /><label>'+t.opts.curLang.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_mailto_text" />'+"</div>"),e.push('<div class="redactor_tab" id="redactor_tab5" style="display: none;"><label>'+t.opts.curLang.anchor+'</label><input type="text" class="redactor_input" id="redactor_link_anchor"  />'+"<label>"+t.opts.curLang.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_anchor_text" />'+"</div>"),e.push("</form>"),e.push("</section>"),e.push("<footer>"),e.push('<a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+t.opts.curLang.cancel+"</a>"),e.push('<input type="button" class="redactor_modal_btn" id="redactor_insert_link_btn" value="'+t.opts.curLang.insert+'" />'),e.push("</footer>"),e.push("</div>"),e.push("</div>"),e.join("")},EditorButtons.Link.InsertLink=function(t){t.selectionRestore();var e,a=$("#redactor_tab_selected").val(),r="",n="",o="";if("1"===a){r=$("#redactor_link_url").val(),n=$("#redactor_link_url_text").val(),$("#redactor_wwwink_blank").attr("checked")&&(o="_blank");var i="((xn--)?[a-z0-9]+(-[a-z0-9]+)*.)+[a-z]{2,}";e=new RegExp("^(http|ftp|https)://"+i,"i");var l=new RegExp("^"+i,"i");-1==r.search(e)&&0==r.search(l)&&t.opts.linkProtocol&&(r=t.opts.linkProtocol+r)}else"2"===a?(r=$("#redactor_site_page").val(),n=$("#redactor_site_page_text").val(),$("#redactor_site_page_blank").attr("checked")&&(o="_blank"),e=new RegExp("^https?://","i"),-1==r.search(e)&&(r=t.opts.protocol+r)):"4"===a?(r="mailto:"+$("#redactor_link_mailto").val(),n=$("#redactor_link_mailto_text").val()):"5"===a&&(r="#"+$("#redactor_link_anchor").val(),n=$("#redactor_link_anchor_text").val());t.linkInsert('<a href="'+r+'" target="'+o+'">'+n+"</a>",$.trim(n),r,o),t.selectionRemove(),t.selectionRemoveMarkers()},EditorButtons.PastePlainText.OpenModal=function(){var t=this;t.selectionSave();var e='<div id="redactor_modal_content"><div id="redactor_modal_inner"><section><textarea id="redactor_paste_plaintext_area" style="height:400px"></textarea></section><footer><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+t.opts.curLang.cancel+"</a>"+'<input type="button" class="redactor_modal_btn" id="redactor_save_plain_text" value="'+t.opts.curLang.insert+'" />'+"</footer>"+"</div>";t.modalInit("Paste Plain Text",e,600,function(){$("#redactor_paste_plaintext_area").bind("paste",function(e){EditorButtons.PastePlainText.ProcessPaste(e,t)}),$("#redactor_save_plain_text").bind("click",function(e){EditorButtons.PastePlainText.SavePaste(e,t)})})},EditorButtons.PastePlainText.ProcessPaste=function(t){$(t.target)},EditorButtons.PastePlainText.SavePaste=function(t,e){var a=$("#redactor_paste_plaintext_area").val();a=e.cleanParagraphy(a),e.selectionRestore(),e.insertHtml(a),e.modalClose()},EditorButtons.NoSettingsAlert=function(){alert("No button settings have been defined")},EditorButtons.Templates.InsertTemplate=function(t){if("undefined"!=typeof Editor.settings&&"undefined"!=typeof Editor.settings.templates&&"undefined"!=typeof Editor.settings.templates.templates&&"undefined"!=typeof Editor.settings.templates.templates[t]){var e=Editor.settings.templates.templates[t].html,a=this;a.selectionRestore(),a.insertHtmlAdvanced(e),a.sync()}},EditorButtons.Styles.OpenDropDown=function(t,e,a,r){var n=this;if("undefined"!=typeof Editor.settings&&"undefined"!=typeof Editor.settings.styles&&"undefined"!=typeof Editor.settings.styles.styles){var o,i=$(e.closest(".redactor_toolbar"));if(0==i.find(".editor-dropdown_styles").length){var l=Editor.settings.styles.styles;i=$('<div class="redactor_dropdown editor-dropdown_styles" style="display:none;"></div>');for(var s=0;s<l.length;s++)o=$('<a class="" style="'+l[s].btn_style+'" class="'+l[s].btn_class+'" href="javascript:void(null);" data-key="'+s+'"><span class="ind"></span>'+l[s].title+"</a>"),o.click(function(t){EditorButtons.Styles.TriggerItem(n,t)}),i.append(o);$(e).parent().before(i)}else i=i.find(".editor-dropdown_styles");n.dropdownShow(r,i,t)}},EditorButtons.Styles.TriggerItem=function(t,e){if(t.bufferSet(),"redactor_box"!=t.getCurrent().className&&"body"!=t.getCurrent().tagName.toLowerCase()){var a,r,n=e.target.getAttribute("data-key"),o=Editor.settings.styles.styles[n],i={};if(o.attr){r=$("<div "+o.attr+">");for(var l=r[0].attributes.length-1;l>=0;l--)i[r[0].attributes[l].name]=r[0].attributes[l].value}o.attr_obj=i;var s=t.getSelectionHtml(),d=$(s);return s||(o.type="current"),d.length>0?(alert("Applying styles to multiple paragraph is not supported"),void 0):("inline"==o.type?EditorButtons.Styles.Exec_Block_Inline("inline",t,o,s):"block"==o.type?EditorButtons.Styles.Exec_Block_Inline("block",t,o,s):"custom"==o.type?EditorButtons.Styles.Exec_Block_Inline("custom",t,o,s):"current"==o.type&&(a=$(t.getCurrent()),a.attr("style",o.styles),a.attr(o.attr_obj),a.addClass(o.classes),Editor.TriggerRedactorCleanup(t)),void 0)}},EditorButtons.Styles.Exec_Block_Inline=function(t,e,a,r){var n,o=$(e.getCurrent());n="inline"==t?$("<div><span></span></div>").find("span"):"block"==t?$("<div><div></div></div>").find("div"):"custom"==t?$("<div><"+a.custom_type+"></"+a.custom_type+"></div>").find(a.custom_type):$("<div><span></span></div>").find("span");var n=n.attr("style",a.styles).attr("class",a.classes).attr(a.attr_obj).html(r).parent().html();o.html(o.html().replace(r,n)),Editor.TriggerRedactorCleanup(e)};