(function(e,t){"use strict";function i(e){return t(e.target).closest(".CVTable").find(".SVWrapperTR").toggle(),!1}function s(e){return 13==e.which?(t(e.target).closest(".CVField").find(".searchbutton").click(),!1):void 0}function r(){var e;w.each(function(i,s){t(s).find(".CVItem").each(function(i,s){t(s).find("input, textarea, select").each(function(){e=t(this).attr("name").replace(/\[videos\]\[.*?\]/,"[videos]["+(i+1)+"]"),t(this).attr("name",e)})}),t(s).find(".CVItem").removeClass("odd"),t(s).find(".CVItem:odd").addClass("odd")})}function a(e){var i=t(e.target).data("id");i&&t.get(ChannelVideos.ACT_URL,{video_id:i,ajax_method:"delete_video"},function(){}),t(e.target).closest(".CVItem").fadeOut("slow",function(){t(this).remove(),r()})}function o(e){return jQuery(e.target).closest(".CVField"),TargetBox.find(".VideosResults .inner").empty(),!1}function n(e){e.preventDefault();var i={},s=t(e.target).closest(".CVField"),r=V["field_"+s.data("field_id")].services;s.find(".SVWrapper .cvsearch").find("input[type=text], input[type=hidden]").each(function(){i[t(this).attr("rel")]=jQuery(this).val()});for(var a=0;r.length>a;a++)s.find(".VideosResults .results-"+r[a]).show().find(".LoadingVideos").show().siblings(".inner").empty(),"youtube"==r[a]?c(i,s):f(i,s)}function d(e,t,i){var s="";0===t.length&&(s+="<p>No Results Found...</p>");for(var r=0;t.length>r;r++)s+='<div class="video" rel="'+e+"|"+t[r].id+'" id="'+e+"__"+t[r].id+'">',s+='<img src="'+t[r].img_url+'" width="100px" height="75px">',s+="<small>"+t[r].title+"</small>",s+="<span>",s+='<a href="'+t[r].vid_url+'" class="play">&nbsp;</a>',s+='<a href="#" class="add">&nbsp;</a>',s+="</span>",s+="</div>";s+='<br clear="all"></div>',i.find(".VideosResults .results-"+e).find(".LoadingVideos").hide().siblings(".inner").show().html(s),i.find(".VideosResults .video .play").colorbox({iframe:!0,width:450,height:375})}function u(e){var i=prompt("Video URL?","");if(null===i)return!1;var s=t(e.target).closest("div.CVField"),r=V["field_"+s.data("field_id")].services;s.find(".SVWrapperTR").show();for(var a=0;r.length>a;a++)s.find(".VideosResults .results-"+r[a]).show().find(".LoadingVideos").show().siblings(".inner").empty(),"youtube"==r[a]?p(i,s):m(i,s);return!1}function h(e,i){var s=V["field_"+i],a=t("#ChannelVideos"+i),o="";a.find("#"+e.service+"__"+e.service_video_id).slideUp();var n=new Date;n.setTime(1e3*e.video_date),"table"==s.layout?(o+='<tr class="CVItem">',o+='<td><a href="'+e.video_url+'" class="PlayVideo"><img src="'+e.video_img_url+'" width="100px" height="75px"></a></td>',o+="<td>"+e.video_title+"</td>",o+="<td>"+e.video_author+"</td>",o+="<td>"+(e.video_duration/60).toFixed(2)+" min</td>",o+="<td>"+e.video_views+"</td>",o+="<td>"+n.toDateString()+"</td>",o+="<td>",o+='<a href="javascript:void(0)" class="MoveVideo">&nbsp;</a>',o+='<a href="javascript:void(0)" class="DelVideo" data-id="'+e.video_id+'">&nbsp;</a>',o+=e.video_id>0?'<input name="'+s.field_name+'[videos][0][video_id]" type="hidden" value="'+e.video_id+'">':'<textarea name="'+s.field_name+'[videos][0][data]" style="display:none">'+JSON.stringify(e)+"</textarea>",o+="</td>",o+="</tr>"):(o+='<div class="CVItem VideoTile">',o+='<a href="'+e.video_url+'" class="PlayVideo"><img src="'+e.video_img_url+'" width="100px" height="75px"></a>',o+="<small>"+e.video_title+"</small>",o+="<span>",o+='<a href="javascript:void(0)" class="MoveVideo">&nbsp;</a>',o+='<a href="javascript:void(0)" class="DelVideo" data-id="'+e.video_id+'">&nbsp;</a>',o+=e.video_id>0?'<input name="'+s.field_name+'[videos][0][video_id]" type="hidden" value="'+e.video_id+'">':'<textarea name="'+s.field_name+'[videos][0][data]" style="display:none">'+JSON.stringify(e)+"</textarea>",o+="</span>",o+="</div>"),a.find(".AssignedVideos .NoVideos").hide(),a.find(".AssignedVideos").append(o),r(),a.find(".AssignedVideos .CVItem .PlayVideo").colorbox({iframe:!0,width:450,height:375})}function l(e){var t=jQuery(e.target).closest("div.video"),i=jQuery(e.target).closest("div.CVField"),s=i.data("field_id");jQuery(e.target).addClass("loading");var r={};return r.ajax_method="get_video",r.service=t.attr("rel").split("|")[0],r.video_id=t.attr("rel").split("|")[1],r.field_id=s,r.field_name=V["field_"+s].field_name,r.field_layout=V["field_"+s].layout,"youtube"==r.service?(_(r.video_id,s,h),!1):(v(r.video_id,s,h),!1)}function c(e,i){var s,r;e.author&&(e.keywords+=" "+e.author),t.ajax({crossDomain:!0,dataType:"json",url:"https://gdata.youtube.com/feeds/api/videos/?v=2&alt=json&callback=?",data:{q:e.keywords,"max-results":e.limit},success:function(e){var t=[];e.feed===void 0&&d("youtube",t,i),e.feed.entry===void 0&&d("youtube",t,i);for(var a=0;e.feed.entry.length>a;a++)s=e.feed.entry[a],r=s.media$group.yt$videoid.$t,t.push({id:r,title:s.title.$t,img_url:"https://i.ytimg.com/vi/"+r+"/default.jpg",vid_url:"https://www.youtube.com/embed/"+r});d("youtube",t,i)}})}function p(e,i){var s,r=i.find(".VideosResults .results-youtube").show(),a=r.find(".inner"),o=r.find(".LoadingVideos"),n=null;return-1===e.indexOf("youtube")&&-1===e.indexOf("youtu.be")?(o.hide(),a.html("<p>Not a valid Youtube URL</p>"),void 0):(e.indexOf("youtube.com/watch")>0?(s=y(e),n=b(s.query,"v")):e.indexOf("youtu.be")>0?(s=e.split("/"),n=s[s.length-1]):e.indexOf("youtube.com/embed")>0&&(s=e.split("/"),n=s[s.length-1]),null===n?(o.hide(),a.html("<p>Could not parse Youtube ID from that URL</p>"),void 0):(t.ajax({crossDomain:!0,dataType:"json",url:"https://gdata.youtube.com/feeds/api/videos/"+n+"?v=2&alt=json&callback=?",success:function(e){var t;o.hide(),e.entry===void 0&&a.html("<p>Youtube could not find the video. (ID: "+n+")</p>"),t=e.entry.media$group.yt$videoid.$t,d("youtube",[{id:t,title:e.entry.title.$t,img_url:"https://i.ytimg.com/vi/"+t+"/default.jpg",vid_url:"https://www.youtube.com/embed/"+t}],i)}}),void 0))}function _(e,i,s){t.ajax({crossDomain:!0,dataType:"json",url:"https://gdata.youtube.com/feeds/api/videos/"+e+"?v=2&alt=json&callback=?",success:function(e){var t=e.entry.media$group.yt$videoid.$t,r={};r.service="youtube",r.service_video_id=t,r.video_id=0,r.video_url="http://www.youtube.com/embed/"+t,r.video_img_url="http://i.ytimg.com/vi/"+t+"/default.jpg",r.video_title=e.entry.title.$t,r.video_desc=e.entry.media$group.media$description.$t,r.video_username=e.entry.author[0].name.$t,r.video_author=e.entry.author[0].name.$t,r.video_author_id=0,r.video_duration=e.entry.media$group.yt$duration.seconds,r.video_views=e.entry.yt$statistics.viewCount,r.video_date=new Date(e.entry.published.$t).getTime()/1e3,s(r,i)}})}function f(e,i){var s,r,a,o=i.find(".VideosResults .results-vimeo").show(),n=o.find(".inner"),u=o.find(".LoadingVideos"),h={};h.format="jsonp",h.method="vimeo.videos.search",h.query=e.keywords,e.author&&(h.user_id=e.author),h.per_page=e.limit,h.full_response="1";var l=g(t.param(h));t.ajax({crossDomain:!0,dataType:"jsonp",url:l,jsonp:!1,jsonpCallback:"vimeoCallback",cache:!0,success:function(e){if("ok"!=e.stat)return u.hide(),n.html("<p>The vimeo request failed!</p>"),void 0;if(0===e.videos.on_this_page)return u.hide(),n.html("<p>No results found..</p>"),void 0;for(var t=[],o=0;e.videos.video.length>o;o++){s=e.videos.video[o];for(var h=s.thumbnails.thumbnail.length-1;h>=0;h--)a=s.thumbnails.thumbnail[h],("100"==a.width||"100"==a.height)&&(r=a._content);t.push({id:s.id,title:s.title,img_url:r,vid_url:"http://player.vimeo.com/video/"+s.id+"?title=0&byline=0&portrait=0"})}d("vimeo",t,i)}})}function m(e,i){var s,r,a,o,n=i.find(".VideosResults .results-vimeo").show(),u=n.find(".inner"),h=n.find(".LoadingVideos"),l=null;if(-1===e.indexOf("vimeo"))return h.hide(),u.html("<p>Not a valid Vimeo URL</p>"),void 0;if(e.indexOf("vimeo.com/")>0&&(s=e.split("/"),l=s[s.length-1]),null===l)return h.hide(),u.html("<p>Could not parse Vimeo ID from that URL</p>"),void 0;var c={};c.format="jsonp",c.method="vimeo.videos.getInfo",c.video_id=l,c.full_response="1",e=g(t.param(c)),t.ajax({crossDomain:!0,dataType:"jsonp",url:e,jsonp:!1,jsonpCallback:"vimeoCallback",cache:!0,success:function(e){if("ok"!=e.stat)return h.hide(),u.html("<p>The vimeo request failed!</p>"),void 0;if(0===e.video.length)return h.hide(),u.html("<p>No results found..</p>"),void 0;for(var t=[],s=0;e.video.length>s;s++){r=e.video[s];for(var n=r.thumbnails.thumbnail.length-1;n>=0;n--)a=r.thumbnails.thumbnail[n],("100"==a.width||"100"==a.height)&&(o=a._content);t.push({id:r.id,title:r.title,img_url:o,vid_url:"http://player.vimeo.com/video/"+r.id+"?title=0&byline=0&portrait=0"})}d("vimeo",t,i)}})}function v(e,i,s){var r,a,o,n={};n.format="jsonp",n.method="vimeo.videos.getInfo",n.video_id=e,n.full_response="1";var d=g(t.param(n));t.ajax({crossDomain:!0,dataType:"jsonp",url:d,jsonp:!1,jsonpCallback:"vimeoCallback",cache:!0,success:function(e){if("ok"!=e.stat)return loading.hide(),inner.html("<p>The vimeo request failed!</p>"),void 0;r=e.video[0];for(var t=r.thumbnails.thumbnail.length-1;t>=0;t--)a=r.thumbnails.thumbnail[t],("100"==a.width||"100"==a.height)&&(o=a._content);var n={};n.service="vimeo",n.service_video_id=r.id,n.video_id=0,n.video_url="http://player.vimeo.com/video/"+r.id+"?title=0&byline=0&portrait=0",n.video_img_url=o,n.video_title=r.title,n.video_desc=r.description,n.video_username=r.owner.username,n.video_author=r.owner.display_name,n.video_author_id=r.owner.id,n.video_duration=r.duration,n.video_views=r.number_of_plays,n.video_date=new Date(r.upload_date.replace(" ","T")+"-00:00").getTime()/1e3,s(n,i)}})}function g(e){var t="nothing",i=new ChannelVideos.OAuthSimple;try{var s=i.sign({path:"https://vimeo.com/api/rest/v2",parameters:e,signatures:{api_key:k,shared_secret:A}});t=s.signed_url}catch(r){alert(r)}return t}function y(e,t){for(var i=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],s={},r=s["phpjs.parse_url.mode"]&&s["phpjs.parse_url.mode"].local_value||"php",a={php:/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/\/?)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},o=a[r].exec(e),n={},d=14;d--;)o[d]&&(n[i[d]]=o[d]);if(t)return n[t.replace("PHP_URL_","").toLowerCase()];if("php"!==r){var u=s["phpjs.parse_url.queryKey"]&&s["phpjs.parse_url.queryKey"].local_value||"queryKey";a=/(?:^|&)([^&=]*)=?([^&]*)/g,n[u]={},n[i[12]].replace(a,function(e,t,i){t&&(n[u][t]=i)})}return delete n.source,n}function b(e,t){for(var i=e,s=i.split("&"),r=0;s.length>r;r++){var a=s[r].split("=");if(decodeURIComponent(a[0])==t)return decodeURIComponent(a[1])}return null}var w,ChannelVideos=e.ChannelVideos=e.ChannelVideos||{},V={};ChannelVideos.Init=function(){w=t(".CVField"),w.each(function(e,i){i=t(i),V["field_"+i.data("field_id")]=JSON.parse(i.find(".jsondata").html())}),w.find(".SearchVideos").click(i),w.find(".SearchVideos input[type=text]").keypress(s),w.find(".SVWrapper .Button").click(n),w.find(".SubmitVideoUrl").click(u),w.delegate(".VideosResults .video .add","click",l),w.delegate(".DelVideo","click",a),w.delegate(".ClearVideoSearch","click",o),w.find(".AssignedVideos").sortable({cursor:"move",opacity:.6,handle:".MoveVideo",update:r,helper:function(e,i){return i.children().each(function(){t(this).width(t(this).width())}),i},forcePlaceholderSize:!0,start:function(e,t){t.placeholder.html('<td colspan="20"></td>')},placeholder:"cvideo-reorder-state-highlight"}),w.find(".AssignedVideos .CVItem .PlayVideo").colorbox({iframe:!0,width:450,height:375})};var k="1a8a81eaf6658d0dbb955f0386f484c1f9b55ece",A="2ffac38d1ee9eac6a2389269aa19429a927ff07b";ChannelVideos.OAuthSimple=function(e,i){return this._secrets={},null!=e&&(this._secrets.consumer_key=e),null!=i&&(this._secrets.shared_secret=i),this._default_signature_method="HMAC-SHA1",this._action="GET",this._nonce_chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",this.setParameters=function(e){return null==e&&(e={}),"string"==typeof e&&(e=this._parseParameterString(e)),this._parameters=e,null==this._parameters.oauth_nonce&&this._getNonce(),null==this._parameters.oauth_timestamp&&this._getTimestamp(),null==this._parameters.oauth_method&&this.setSignatureMethod(),null==this._parameters.oauth_consumer_key&&this._getApiKey(),null==this._parameters.oauth_token&&this._getAccessToken(),this},this.setQueryString=function(e){return this.setParameters(e)},this.setURL=function(e){if(""==e)throw"No path specified for OAuthSimple.setURL";if(-1!=e.indexOf(" "))throw t("#path").select(),"Space detected in request path/URL";return this._path=e,this},this.setPath=function(e){return this.setURL(e)},this.setAction=function(e){if(null==e&&(e="GET"),e=e.toUpperCase(),e.match("[^A-Z]"))throw"Invalid action specified for OAuthSimple.setAction";return this._action=e,this},this.setTokensAndSecrets=function(e){if(e)for(var t in e)this._secrets[t]=e[t];if(this._secrets.api_key&&(this._secrets.consumer_key=this._secrets.api_key),this._secrets.access_token&&(this._secrets.oauth_token=this._secrets.access_token),this._secrets.access_secret&&(this._secrets.oauth_secret=this._secrets.access_secret),null==this._secrets.consumer_key)throw"Missing required consumer_key in OAuthSimple.setTokensAndSecrets";if(null==this._secrets.shared_secret)throw"Missing required shared_secret in OAuthSimple.setTokensAndSecrets";if(null!=this._secrets.oauth_token&&null==this._secrets.oauth_secret)throw"Missing oauth_secret for supplied oauth_token in OAuthSimple.setTokensAndSecrets";return this},this.setSignatureMethod=function(e){if(null==e&&(e=this._default_signature_method),null==e.toUpperCase().match(/(PLAINTEXT|HMAC-SHA1)/))throw"Unknown signing method specified for OAuthSimple.setSignatureMethod";return this._parameters.oauth_signature_method=e.toUpperCase(),this},this.sign=function(e){null==e&&(e={}),null!=e.action&&this.setAction(e.action),null!=e.path&&this.setPath(e.path),null!=e.method&&this.setSignatureMethod(e.method),this.setTokensAndSecrets(e.signatures),null!=e.parameters&&this.setParameters(e.parameters);var t=this._normalizedParameters(),i=this._generateSignature(t);return this._parameters.oauth_signature=i.signature,{parameters:this._parameters,sig_string:i.sig_string,signature:this._oauthEscape(this._parameters.oauth_signature),signed_url:this._path+"?"+this._normalizedParameters(),header:this.getHeaderString()}},this.getHeaderString=function(e){null==this._parameters.oauth_signature&&this.sign(e);var t="OAuth ";for(var i in this._parameters)if(null!=i.match(/^oauth/))if(this._parameters[i]instanceof Array)for(var s=this._parameters[i].length,r=0;s>r;r++)t+=i+'="'+this._oauthEscape(this._parameters[i][r])+'" ';else t+=i+'="'+this._oauthEscape(this._parameters[i])+'" ';return t},this._parseParameterString=function(e){for(var t=e.split("&"),i={},s=t.shift();s;s=t.shift()){var r,a=s.split("=");a[1]&&(r=decodeURIComponent(a[1])),i[a[0]]?i[a[0]]instanceof Array?i[a[0]].push(r):i[a[0]]=[i[a[0]],r]:i[a[0]]=r}return i},this._oauthEscape=function(e){if(null==e)return"";if(e instanceof Array)throw"Array passed to _oauthEscape";return encodeURIComponent(e).replace(/\!/g,"%21").replace(/\*/g,"%2A").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")},this._getNonce=function(e){null==e&&(e=5);for(var t="",i=this._nonce_chars.length,s=0;e>s;s++){var r=Math.floor(Math.random()*i);t+=this._nonce_chars.substring(r,r+1)}return this._parameters.oauth_nonce=t,t},this._getApiKey=function(){if(null==this._secrets.consumer_key)throw"No consumer_key set for OAuthSimple.";return this._parameters.oauth_consumer_key=this._secrets.consumer_key,this._parameters.oauth_consumer_key},this._getAccessToken=function(){if(null==this._secrets.oauth_secret)return"";if(null==this._secrets.oauth_token)throw"No oauth_token (access_token) set for OAuthSimple.";return this._parameters.oauth_token=this._secrets.oauth_token,this._parameters.oauth_token},this._getTimestamp=function(){var e=new Date,t=Math.floor(e.getTime()/1e3);return this._parameters.oauth_timestamp=t,t},this._normalizedParameters=function(){var e=[],t=[],i=0;for(var s in this._parameters){if(i++>1e3)throw"runaway 1";t.unshift(s)}t=t.sort();for(var r=t.length,a=0;r>a;a++)if(s=t[a],!s.match(/\w+_secret/))if(this._parameters[s]instanceof Array)for(var o=this._parameters[s].sort(),n=o.length,d=0;n>d;d++){if(i++>1e3)throw"runaway 1";e.push(this._oauthEscape(s)+"="+this._oauthEscape(o[d]))}else e.push(this._oauthEscape(s)+"="+this._oauthEscape(this._parameters[s]));return e.join("&")},this.b64_hmac_sha1=function(e,t,i,s){function r(e,t,i,s){return 20>e?t&i|~t&s:40>e?t^i^s:60>e?t&i|t&s|i&s:t^i^s}function a(e){return 20>e?1518500249:40>e?1859775393:60>e?-1894007588:-899497514}function o(e,t){var i=(65535&e)+(65535&t),s=(e>>16)+(t>>16)+(i>>16);return s<<16|65535&i}function n(e,t){return e<<t|e>>>32-t}function d(e,t){e[t>>5]|=128<<24-t%32,e[(t+64>>9<<4)+15]=t;for(var i=[80],s=1732584193,d=-271733879,u=-1732584194,h=271733878,l=-1009589776,c=0;e.length>c;c+=16){for(var p=s,_=d,f=u,m=h,v=l,g=0;80>g;g++){i[g]=16>g?e[c+g]:n(i[g-3]^i[g-8]^i[g-14]^i[g-16],1);var y=o(o(n(s,5),r(g,d,u,h)),o(o(l,i[g]),a(g)));l=h,h=u,u=n(d,30),d=s,s=y}s=o(s,p),d=o(d,_),u=o(u,f),h=o(h,m),l=o(l,v)}return[s,d,u,h,l]}function u(e){for(var t=[],i=(1<<s)-1,r=0;e.length*s>r;r+=s)t[r>>5]|=(e.charCodeAt(r/8)&i)<<32-s-r%32;return t}function h(e,t){var i=u(e);i.length>16&&(i=d(i,e.length*s));for(var r=[16],a=[16],o=0;16>o;o++)r[o]=909522486^i[o],a[o]=1549556828^i[o];var n=d(r.concat(u(t)),512+t.length*s);return d(a.concat(n),672)}function l(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s="",r=0;4*e.length>r;r+=3)for(var a=(255&e[r>>2]>>8*(3-r%4))<<16|(255&e[r+1>>2]>>8*(3-(r+1)%4))<<8|255&e[r+2>>2]>>8*(3-(r+2)%4),o=0;4>o;o++)s+=8*r+6*o>32*e.length?i:t.charAt(63&a>>6*(3-o));return s}function c(e,t){return l(h(e,t))}return i||(i="="),s||(s=8),c(e,t)},this._generateSignature=function(){var e=this._oauthEscape(this._secrets.shared_secret)+"&"+this._oauthEscape(this._secrets.oauth_secret);if("PLAINTEXT"==this._parameters.oauth_signature_method)return{sig_string:null,signature:e};if("HMAC-SHA1"==this._parameters.oauth_signature_method){var t=this._oauthEscape(this._action)+"&"+this._oauthEscape(this._path)+"&"+this._oauthEscape(this._normalizedParameters());return{sig_string:t,signature:this.b64_hmac_sha1(e,t)}}return null},this}})(window,jQuery),$(document).ready(function(){ChannelVideos.Init()});
//@ sourceMappingURL=/themes/third_party/channel_videos/js/pbf.min.map